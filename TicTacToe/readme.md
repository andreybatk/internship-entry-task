# TicTacToe NxN - REST API

REST API для игры в крестики-нолики с размером поля NxN (N >= 3) с поддержкой стандартных правил и дополнительным правилом: каждый третий ход с вероятностью 10% ставится символ противника.

---

## Содержание

- [Описание проекта](#описание-проекта)
- [Архитектура](#архитектура)
- [Используемые технологии](#используемые-технологии)
- [API](#api)
- [Паттерн Result](#паттерн-result)
- [Запуск через Docker](#запуск-через-docker)
- [Тесты](#тесты)

---

## Описание проекта

Данный проект реализует серверную часть игры "Крестики-нолики" с настраиваемым размером поля и условиями победы. Важной особенностью является нестандартное правило, при котором каждый третий ход может быть инверсией (символ противника ставится с вероятностью 10%).

---

## Архитектура

Применена многослойная архитектура:

- **API**
- **BL (Business Logic)** 
- **Contracts**
- **DB (Data Access Layer)**
- **Tests**

---

## Используемые технологии

- .NET 9
- Entity Framework Core (PostgreSQL)
- PostgreSQL (в Docker контейнере)
- Docker & Docker Compose для локального запуска и деплоя
- xUnit + Moq + Sqlite для тестирования
- JSON (сериализация) с поддержкой строковых enum

---

## API

### Создание новой игры

**POST** `/api/game?playerXId={guid}&playerOId={guid}`

- Создаёт новую игру между двумя игроками.
- Возвращает созданную игру.

### Сделать ход

**POST** `/api/game/move?gameId={guid}&playerId={guid}&x={int}&y={int}`

- Совершает ход в указанной игре.
- Возвращает обновлённое состояние игры.
- При повторном одинаковом запросе — идемпотентно возвращает текущий результат с тем же ETag.

### Получить игру по ID

**GET** `/api/game/{gameId}`

- Возвращает текущее состояние игры с ходами.

---

## Паттерн Result

Для унифицированной обработки ошибок и успешных результатов используется кастомный паттерн `ServiceResult<T>` с полями:

- `Success` — статус операции
- `Data` — результат при успехе
- `ErrorMessage` — сообщение об ошибке при неудаче

Это упрощает обработку ошибок и повышает читаемость кода.

---

## Запуск через Docker

1. Соберите и запустите контейнеры командой:

```bash
docker-compose up --build
